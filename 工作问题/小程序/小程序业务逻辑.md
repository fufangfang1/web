#### 点击链接跳转到指定页面

#### 订阅消息如何实现

#### 小程序下拉刷新

小程序在刷新页面时，主要有两种方式。

##### 拉动页面刷新（手动刷新）

- 在json文件中将enablePullDownRefresh设置为true，在Page中监听onPullDownRefresh事件即可。支持点击顶部标题栏回到顶部，自定义标题栏时会失效。

```json
{
  "enablePullDownRefresh": true
}
```

```js
// 页面监听下拉刷新

onPullDownRefresh(){
 console.log('下拉刷新了'),
//  如果需要下拉刷新数据，把数据或者接口写到此处
},
```

>弊端

仅在json中配置，下拉刷新是没有任何效果的，就说页面下移了而已，可以配合小程序的方法：showNavigationBarLoading()和showNavigationBarLoading()，代码如下：

```js

Page({


  refreshPage: function () {
    wx.showNavigationBarLoading() // 显示导航条加载动画

    // 可在这里调用接口或更新某种数据

 this.setData({
      // 更新数据
    })


// 更新完之后，调用一个定时器，给用户以提示，如果没有定时器，将隐藏导航栏和显示导航栏都写在refreshPage函数下，会出现没有效果，即导航条还没来得及显示，就已经被隐藏了。所以，它俩必不能同步。

    setTimeout(function () {
      wx.hideNavigationBarLoading() // 隐藏导航条加载动画
      wx.showToast({
        title: '刷新成功',
        icon: 'success',
        duration: 2000
      })
    }, 2000);
  }
})


onPullDownRefresh(){
  // 当监测到下拉刷新时，更新数据
 this.refreshData()
},

```

##### API刷新

- 调用wx.startPullDownRefresh()触发下拉刷新事件，产生下拉刷新动画，处理完下拉刷新中的数据更新后调用wx.stopPullDownRefresh()结束动画即可。

```wxml
<button bind:tap='refrash'>点击刷新</button>
```

```js
Page({

refrash(){
  // 开启下拉刷新
  wx.startPullDownRefresh(
     wx.showNavigationBarLoading(),//显示导航条加载动画
    console.log('开始刷新'),

    //有更新数据或者调用接口，写到此处

    this.setData({
      // 更新数据
    })

  )

  setTimeout((function(){
     wx.hideNavigationBarLoading() // 隐藏导航条加载动画
    wx.stopPullDownRefresh()//关闭下来刷新
  }),1000)
},
})
```

>避雷！

- 切记不要在onPullDownRefresh()方法里再去使用wx.startPullDownRefresh(),两者套用会使页面一直处在下拉刷新的状态，永远不会继续往下执行。（本人在套用使用的时候，startPullDownRefresh（）里面写的有接口，导致执行的时候，一直返回数据，直到栈溢出，并没有执行下面的stopPullDownRefresh()）

>总结：

1. 无论是哪种刷新，json中都需要配置  "enablePullDownRefresh": true,否则任何方式的下拉刷新都不会起效果。

2. 如果是手动下拉刷新，在onPullDownRefresh()方法里只有stopPullDownRefresh()即可，如果是API控制的刷新，startPullDownRefresh和stopPullDownRefresh一定要共存。（onPullDownRefresh中以on开头，就是开始，执行，处在某种状态的意思，而startPullDownRefresh中以start开头，也是开始，执行的意思。两个单词要表达的意思，几乎是差不多的，所以为什么要开始两次呢？？）