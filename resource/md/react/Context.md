## Context
>上下文: 表示做某一些事情的环境
React上下文的特点：
1. 当某个组件创建了上下文后，上下文中的数据会被所有后代组件共享
2. 如果某个组件依赖了上下文，会导致该组件不再纯粹(外部属性仅来源于属性props)
3. 一般情况下，用于第三方组件

## 旧版上下文 16版本之前
>如何创建上下文
1. 给类组件书写静态属性， childContextTypes 使用该属性对上下文中的数据类型进行约束
2. 添加实例方法getChildContext，该方法返回的对象，即为上下文中的数据，该数据必须满足类型约束，该方法会在每次render之后运行

#### 使用上下文中的数据、
要求： 如果要使用上下文中的数据，组件必须有一个静态属性 contextTypes，该属性描述了需要获取上下文中的数据类型
1. 可以在组件的构造函数中，通过第二个参数，获取上下文
2. **从类组件的context属性中获取**(常用)
3. 在函数组件中通过第二个参数获取上下文数据

- 上下文中的数据变化不可以直接变化，最终都是通过状态改变(就是上下文中的数据来自于state)
- 如果想要在子组件中改变上下文的数据，在上下文中加入一个处理函数，可以用于后代更改上下文中的数据
- 如果一个组件的父组件和祖先组件都有上下文，遵循就近原则

## 新版Context 16版本之后

#### 创建上下文
- 上下文是一个独立于组件的对象(更加纯粹) 该对象通过React.createContext()创建
- 返回的是一个包含两个属性的对象 
  - Provider属性  生产者。一个组件，该组件会创建一个上下文。该组件有一个value属性
  - 同一个Provider不能用到多个组件中，如果需要在其他组件中使用该数据，应该考虑将数据提升到更高的层次
  - Consumer属性  
#### 使用上下文中的数据
- 在类组件中需要使用this.context获取上下文数据
  - 要求： 如果要使用上下文中的数据，组件必须有一个静态属性 contextType，该属性是一个上下文对象 ctx = React.createContext()
- 再类组件中也可以用Consumer来获取 同样不需要设置静态属性
- 在函数组件中，需要使用Consumer来获取上下文数据(不需要设置静态属性contextType)
  - Consumer是一个组件
  - 他的子节点，是一个函数(它的props.children需要传递一个函数)

**注意细节**
如果，上下文的提供者(Context.Provider)中的value属性发生变化(Object.is比较)
会导致该上下文提供的所有后代元素全部重新渲染，无论该子元素是否有优化(无论shouldComponentUpdate函数返回甚末结果:因为每一次setState返回的都是一个全新的对象)
这样做会降低性能优化
改变方法(提升优化):就是需要在state中再套一层对象
```js
<ctx.Provider value = { this.state.ctx }></ctx.Provider>
// 不直接传递this.state对象
state = {
    ctx:{
        在这里书写数据
    }
}
这样就可以实现优化
```